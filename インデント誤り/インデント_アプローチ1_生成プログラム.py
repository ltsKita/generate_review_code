import docx
import re

def word校閲(word_file):
    doc = docx.Document(word_file)
    for para in doc.paragraphs:
        for run in para.runs:
            text = run.text
            lines = text.split('\n')
            for i, line in enumerate(lines):
                if line.lstrip().startswith('インデント'):
                    indent_level = len(line.lstrip().split()[0])
                    if indent_level > 0:
                        if para.runs[-1].text.endswith('\n'):
                            para.runs[-1].text +='' * indent_level * '\t'
                        else:
                            para.runs.append(docx.Run(text=''* indent_level * '\t'))
                else:
                    lines[i] = line.lstrip()
            para.text = '\n'.join(lines)

    return doc

def highlight_word(word_file):
    doc = word_file
    for para in doc.paragraphs:
        for run in para.runs:
            text = run.text
            lines = text.split('\n')
            for i, line in enumerate(lines):
                if re.search(r'\b(\w+\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\s*\(\d+\)\s*,?\